var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function a(t){try{u(i.next(t))}catch(e){o(e)}}function s(t){try{u(i["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,s)}u((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(i){n=[6,i],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,o,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},Animation=function(){function t(){}return t["new"]=function(){return t.cht||(t.cht=new t),t.cht},t.prototype.playAnimation=function(t,e){if(e)for(var n in t.items)t.items[n].props={loop:!0};t.play()},t.prototype.talBox=function(t,e){var n=new eui.Group,i=new eui.Label;n.addChild(i),i.size=40,i.textColor=3355443,i.bold=!0,i.lineSpacing=10,i.text=t,i.width=e.stage.stageWidth-320,i.verticalAlign="top",i.textAlign="left",i.x=160;var r=i.height>160?i.height:160;i.y=e.stage.stageHeight-r-70;var o=new egret.Bitmap,a=RES.getRes("dialog-bg_png");return o.texture=a,n.addChild(o),o.alpha=.8,o.width=e.stage.stageWidth-120,o.height=r+100,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,o.x=e.stage.stageWidth/2,o.y=e.stage.stageHeight-o.height/2-20,o.scale9Grid=new egret.Rectangle(84,84,572,572),n.swapChildren(i,o),n},t.prototype.talkAnimation=function(t,e){return __awaiter(this,void 0,void 0,function(){var n,i,r;return __generator(this,function(o){switch(o.label){case 0:n=t.text,i=function(i){var r;return __generator(this,function(o){switch(o.label){case 0:return r=egret.Tween.get(t,egret.Ease.sineIn),r.to({text:n.substr(0,i)},0),r.to({text:n.substr(0,i+1)},e),[4,new Promise(function(t,e){r.call(function(e){t(e)},r)})];case 1:return o.sent(),[2]}})},r=0,o.label=1;case 1:return r<n.length?[5,i(r)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},t.prototype.DelayCall=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,new Promise(function(e){setTimeout(function(){e()},t)})];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),console.log(e),[3,3];case 3:return[2]}})})},t}();__reflect(Animation.prototype,"Animation");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?i(r):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return egret.TextField.default_fontFamily="girl",[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return e.sent(),[4,this.loadTheme()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),console.error(t),[3,4];case 4:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var i=new eui.Theme("resource/default.thm.json",t.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){this.addChild(indexLoading["new"]())},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function r(t){e.call(i,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}var a=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(i,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(i,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var u=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(i,generateJSON.paths[t])},this):RES.getResByUrl(u,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){e.call(i,generateJSON.paths[t])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(i,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var LoadingUI=function(t){function e(e){void 0===e&&(e="更新资源准备加载中...");var n=t.call(this)||this;return n.text=e,n.addEventListener(egret.Event.ADDED_TO_STAGE,n.createView,n),n}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=this.stage.stageWidth,this.textField.size=24,this.textField.text=this.text,this.textField.textAlign="center"},e.prototype.setTitle=function(t){this.text=t},e.prototype.onProgress=function(t,e,n){this.textField.text=""+this.text+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var chapter=function(t){function e(){var e=t.call(this)||this;return e.talactive=0,e.talkjson=[{ascription:0,text:"初春饰利：今年天气很好呢！黑子同学约我和泪子出去玩呢。"},{ascription:1,text:"初春饰利：佐天同学怎么还没到啊。"},{ascription:2,text:"佐天泪子：抱歉抱歉，路上堵了~"},{ascription:2,text:"初春饰利：哼，原谅你了~"},{ascription:3,text:"白井黑子：初春，这位就是常盘台的超电磁炮，御坂美琴姐姐大人！"},{ascription:3,text:"御坂美琴：黑子！！！ = =#"},{ascription:3,text:"白井黑子：哈哈，这位是我说的风纪委员的朋友初春饰利和她的朋友。"},{ascription:4,text:"佐天泪子：你好，我是佐天泪子，Lv0无能力者。"},{ascription:4,text:"初春饰利：佐天同学说什么啊。"},{ascription:5,text:"boom！！！轰轰轰！！！"},{ascription:6,text:"白井黑子：初春，联系警备员以及确认伤员就交给你了，请加抓紧时间！"},{ascription:7,text:"御坂美琴：黑子！"},{ascription:7,text:"白井黑子：这可不行，姐姐大人！"},{ascription:8,text:"白井黑子：维护学员都市的治安可是我们风纪委员的工作，这次请您务必不要插手。"}],e}return __extends(e,t),e["new"]=function(){return e.cht||(e.cht=new e),e.cht},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Animation["new"]().DelayCall(1e3)];case 1:return e.sent(),this.bjTap(),[3,3];case 2:return t=e.sent(),console.log(t),[3,3];case 3:return[2]}})})},e.prototype.createdText=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.talbox=Animation["new"]().talBox(t,this),this.addChild(this.talbox),[4,Animation["new"]().talkAnimation(this.talbox.getChildAt(1),100)];case 1:return e.sent(),[2]}})})},e.prototype.bjTap=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this.talkjson[this.talactive],t.ascription>0&&(SoundManager["new"]().playClick(),this.bgbox.getChildAt(t.ascription-1).visible=!1),this.bgbox.getChildAt(t.ascription).visible=!0,this.talbox&&this.removeChild(this.talbox),[4,this.createdText(t.text)];case 1:return n.sent(),this.talactive<this.talkjson.length-1&&(this.talactive++,this.once(egret.TouchEvent.TOUCH_TAP,this.bjTap,this)),[3,3];case 2:return e=n.sent(),console.log(e),[3,3];case 3:return[2]}})})},e}(eui.Component);__reflect(chapter.prototype,"chapter",["eui.UIComponent","egret.DisplayObject"]);var detail=function(t){function e(){var e=t.call(this)||this;return e.shuainum=0,e.loadingnum=4,e.fenshunum=0,e._armatureDisplay=[],e.delay=1e3,e.delay2=6e3,e.addjs=function(){var t=dragonBones.EgretFactory.factory;0===e._armatureDisplay.length&&(t.parseDragonBonesData(RES.getRes("SwordsMan_ske_json")),t.parseTextureAtlasData(RES.getRes("SwordsMan_tex_json"),RES.getRes("SwordsMan_tex_png")));var n=t.buildArmatureDisplay("Swordsman");n.x=e.stage.stageWidth,n.y=500,n.scaleX=-.4,n.scaleY=.4,n.animation.play("walk"),e.addChild(n),e.rwAnimation(n,e.delay2),e.delay=e.sum(500,3e3),e.delay2-=100,e.delay<500&&(e.delay=500),e.delay2<500&&(e.delay2=500),e.repeatTime=setTimeout(e.addjs,e.delay)},e}return __extends(e,t),e["new"]=function(){return e.cht||(e.cht=new e),e.cht},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){this.addEvent();var t=new egret.Timer(1e3,5);t.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),t.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),t.start()},e.prototype.timerFunc=function(t){this.loading.text=this.loadingnum--+""},e.prototype.timerComFunc=function(){this.loading.visible=!1,this.addjs()},e.prototype.rwAnimation=function(t,e){var n=this,i=egret.Tween.get(t).to({x:0,scaleX:"-0.4",scaleY:"0.4"},e).call(function(){var e=n.findArmatureDisplayIndexByhascode(t.hashCode);-1!=e&&n._armatureDisplay.splice(e,1),n.removeChild(t)});this._armatureDisplay.push({display:t,animate:i})},e.prototype.sum=function(t,e){var n=Math.floor(Math.random()*(t-e)+e);return n},e.prototype.addEvent=function(){this.btn_left.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClick,this)},e.prototype.onButtonClick=function(t){var e=this,n=this.mofazhen,i=this._armatureDisplay.findIndex(function(t){return t.display.x>n.x&&t.display.x<n.x+n.width});if(-1!==i){var r=this._armatureDisplay[i].display;if(console.log(Math.abs(r.x-(this.mofazhen.x+this.mofazhen.width/2))),Math.abs(r.x-(this.mofazhen.x+this.mofazhen.width/2))<30?(this.shuai.text="帅B"+(this.shuainum>0?this.shuainum+"连":""),this.shuainum++,this.fenshunum+=1e3+1e3*this.shuainum):(this.shuai.text="一般般不帅",this.shuainum=0,this.fenshunum+=200),this.fenshu.text=""+this.fenshunum,this.shuai.visible=!0,this.shuainum>3){clearTimeout(this.repeatTime),this.jscontrol(!0),this.dbtx_group.visible=!0,this.setChildIndex(this.dbtx_group,98),this.setChildIndex(r,99);egret.Tween.get(r).to({x:this.stage.stageWidth/2,scaleX:"-0.6",scaleY:"0.6"},300).call(function(){r.animation.play("jump",1),r.addEventListener(dragonBones.EventObject.COMPLETE,e.animationEventHandler,e)});this.shuainum=0}else r.animation.play("jump",1),this._armatureDisplay.splice(i,1)}},e.prototype.jscontrol=function(t){for(var e in this._armatureDisplay)this._armatureDisplay[e].animate.setPaused(t)},e.prototype.findArmatureDisplayIndexByhascode=function(t){return this._armatureDisplay.findIndex(function(e,n){return e.display.hashCode===t})},e.prototype.globalHandler=function(t){console.log("全局操作",t)},e.prototype.touchHandler=function(t){console.log("舞台点击")},e.prototype.animationEventHandler=function(t){var e=t.currentTarget,n=this.findArmatureDisplayIndexByhascode(e.hashCode);switch(t.type){case dragonBones.EventObject.COMPLETE:var i=t.eventObject.animationState.name;"jump"===i?e.animation.play("attack1",1):"attack1"===i&&(this.dbtx_group.visible=!1,this.jscontrol(!1),this.addjs(),this._armatureDisplay.splice(n,1),e.animation.play("walk"))}},e}(eui.Component);__reflect(detail.prototype,"detail",["eui.UIComponent","egret.DisplayObject"]);var index=function(t){function e(){return t.call(this)||this}return __extends(e,t),e["new"]=function(){return e.cht||(e.cht=new e),e.cht},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]),SoundManager["new"]().playBgMusic(0),this.background.filters=[this.createdFilter()];for(t in this.dh1.items)this.dh1.items[t].props={loop:!0};return this.loadingView=new LoadingUI("第一次加载核心资源哦，耐心等待下拉..."),this.addChild(this.loadingView),this.loadingView.y=this.mask_box.y+25,[4,RES.loadGroup("scene",0,this.loadingView)];case 1:return n.sent(),this.loadingView.setTitle("加载图片资源，耐心等待下拉..."),[4,RES.loadGroup("cg",0,this.loadingView)];case 2:return n.sent(),this.removeChild(this.loadingView),this.start.visible=!0,this.dh1.play(),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bjTap,this),[3,4];case 3:return e=n.sent(),console.log(e),[3,4];case 4:return[2]}})})},e.prototype.bjTap=function(t){SoundManager["new"]().playClick(),SoundManager["new"]().playBgMusic(1),this.parent.addChild(chapter["new"]()),this.parent.removeChild(this)},e.prototype.createdFilter=function(){var t="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",e="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nuniform float customUniform;\nvoid main(void) {\nvec2 uvs = vTextureCoord.xy;\nvec4 fg = texture2D(uSampler, vTextureCoord);\nfg.rgb += sin(customUniform + uvs.x * 2. + uvs.y * 2.) * 0.2;\ngl_FragColor = fg * vColor;\n}",n=new egret.CustomFilter(t,e,{customUniform:0});return this.addEventListener(egret.Event.ENTER_FRAME,function(){n.uniforms.customUniform+=.1,n.uniforms.customUniform>2*Math.PI&&(n.uniforms.customUniform=0)},this),n},e}(eui.Component);__reflect(index.prototype,"index",["eui.UIComponent","egret.DisplayObject"]);var indexLoading=function(t){function e(){return t.call(this)||this}return __extends(e,t),e["new"]=function(){return e.cht||(e.cht=new e),e.cht},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.loadingView=new LoadingUI("装载核心..."),this.addChild(this.loadingView),this.loadingView.y=360,[4,RES.loadGroup("preload",0,this.loadingView)];case 1:return e.sent(),this.removeChild(this.loadingView),this.dh1.addEventListener(egret.Event.COMPLETE,this.onTweenGroupComplete,this),this.dh1.play(),[3,3];case 2:return t=e.sent(),console.log(t),[3,3];case 3:return[2]}})})},e.prototype.onTweenGroupComplete=function(){this.dh1.removeEventListener(egret.Event.COMPLETE,this.onTweenGroupComplete,this),this.dispatchEvent(new egret.Event(egret.Event.COMPLETE)),this.parent.addChild(index["new"]()),this.parent.removeChild(this)},e}(eui.Component);__reflect(indexLoading.prototype,"indexLoading",["eui.UIComponent","egret.DisplayObject"]);var SoundManager=function(){function t(){this.click_sound=new egret.Sound,this.click_sound=RES.getRes("bintap_mp3")}return t["new"]=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.playBgMusic=function(t){void 0===t&&(t=0),this.stopBgMusic();var e=["index_bgm_mp3","index_bgm2_mp3"];this.bg_sound=RES.getRes(e[t]),this.bg_sound&&this.isMusic&&(this.soundChannel=this.bg_sound.play(0,0))},t.prototype.stopBgMusic=function(){this.soundChannel&&this.soundChannel.stop()},t.prototype.playClick=function(){this.isEffect&&this.click_sound&&this.click_sound.play(0,1)},t.prototype.playTapWord=function(){this.isEffect&&this.tapWord_sound&&this.tapWord_sound.play(0,1)},t.prototype.playRight=function(){this.isEffect&&this.right_sound&&this.right_sound.play(0,1)},t.prototype.playWrong=function(){this.isEffect&&this.wrong_sound&&this.wrong_sound.play(0,1)},Object.defineProperty(t.prototype,"isMusic",{get:function(){var t=egret.localStorage.getItem("isMusic");return null==t||""==t?!0:"1"==t},set:function(t){t?(egret.localStorage.setItem("isMusic","1"),this.playBgMusic()):(egret.localStorage.setItem("isMusic","0"),this.stopBgMusic())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEffect",{get:function(){var t=egret.localStorage.getItem("isSound");return null==t||""==t?!0:"1"==t},set:function(t){t?egret.localStorage.setItem("isSound","1"):egret.localStorage.setItem("isSound","0")},enumerable:!0,configurable:!0}),t}();__reflect(SoundManager.prototype,"SoundManager");